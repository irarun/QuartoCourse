{
  "hash": "b28019bc983488612eccae714eb2b34c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"analysis\"\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(babynames)\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(pheatmap)\n```\n:::\n\n\nNow we will examine the babynames dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(babynames) |> kable()\n```\n\n::: {.cell-output-display}\n\n\n| year|sex |name      |    n|      prop|\n|----:|:---|:---------|----:|---------:|\n| 1880|F   |Mary      | 7065| 0.0723836|\n| 1880|F   |Anna      | 2604| 0.0266790|\n| 1880|F   |Emma      | 2003| 0.0205215|\n| 1880|F   |Elizabeth | 1939| 0.0198658|\n| 1880|F   |Minnie    | 1746| 0.0178884|\n| 1880|F   |Margaret  | 1578| 0.0161672|\n\n\n:::\n:::\n\n\nTo create a visualization of the most popular baby names, we have created two functions. Click the 'Code' link to view:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_most_frequent <- function(babynames, select_sex, from = 1950) {\n  most_freq <- babynames |>\n    filter(sex == select_sex, year > from) |>\n    group_by(name) |>\n    summarise(average = mean(prop)) |>\n    arrange(desc(average))\n    \n  return(list(\n    babynames = babynames,\n    most_frequent = most_freq,\n    sex = select_sex,\n    from = from))\n}\n\nplot_top <- function(x, top = 10) {\n  topx <- x$most_frequent$name[1:top]\n  \n  p <- x$babynames |>\n    filter(name %in% topx, sex == x$sex, year > x$from) |>\n    ggplot(aes(x = year, y = prop, color = name)) +\n    geom_line() +\n    scale_color_brewer(palette = \"Paired\") +\n    theme_classic()\n  \n  return(p)\n}\n```\n:::\n\n\n```         \nHere we call the code to visualize the top 10 most frequent girl names from 1950 onwards:\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_most_frequent(babynames, select_sex = \"F\") |>\n  plot_top()\n```\n\n::: {.cell-output-display}\n![Line plot displaying proportion of top 10 girl names by year](test_website_files/figure-html/fig-line-girls-1.png){#fig-line-girls width=672}\n:::\n:::\n\n\n```         \nIn @fig-line-girls you can see that there has been a peak in popularity for 'Lisa', 'Jennifer' and 'Jessica'. Interesting! Let's have a look at the boys names:\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_most_frequent(babynames, select_sex = \"M\") |>\n  plot_top()\n```\n\n::: {.cell-output-display}\n![Line plot displaying proportion of top 10 boy names by year](test_website_files/figure-html/fig-line-boys-1.png){#fig-line-boys width=672}\n:::\n:::\n\n\n\n::: {#fig-line-2010 .cell layout=\"[[50,50],[100]]\"}\n\n```{.r .cell-code}\n# get most frequent girl names from 2010 onwards\nfrom_year <- 2010\nmost_freq_girls <- get_most_frequent(babynames, select_sex = \"F\",\n                                     from = from_year)\n\n# plot top 5 girl names\nmost_freq_girls |>\n  plot_top(top = 5)\n\n# plot top 10 girl names\nmost_freq_girls |>\n  plot_top(top = 10)\n\n# get top 30 girl names in a matrix\n# with names in rows and years in columns\nprop_df <- babynames |> \n  filter(name %in% most_freq_girls$most_frequent$name[1:30] & sex == \"F\") |>\n  filter(year >= from_year) |> \n  select(year, name, prop) |>\n  pivot_wider(names_from = year,\n              values_from = prop)\n\nprop_mat <- as.matrix(prop_df[, 2:ncol(prop_df)])\nrownames(prop_mat) <- prop_df$name\n\n# create heatmap\npheatmap(prop_mat, cluster_cols = FALSE, scale = \"row\")\n```\n\n::: {.cell-output-display}\n![Top 5](test_website_files/figure-html/fig-line-2010-1.png){#fig-line-2010-1 width=672}\n:::\n\n::: {.cell-output-display}\n![Top 10](test_website_files/figure-html/fig-line-2010-2.png){#fig-line-2010-2 width=672}\n:::\n\n::: {.cell-output-display}\n![Top 30](test_website_files/figure-html/fig-line-2010-3.png){#fig-line-2010-3 width=672}\n:::\n\nMost popular girl names from 2010 onwards\n:::\n\n\nIn @fig-line-2010-1 and @fig-line-2010-1 the line plots are shown. To view trends of many names at once, @fig-line-2010-3 displays a heatmap.\n",
    "supporting": [
      "test_website_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}